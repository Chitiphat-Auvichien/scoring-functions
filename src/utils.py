import numpy as np

# Full atomic masses dictionary
atomicMass = {
    'al':26.981538, 'sb':121.76, 'ar':39.948, 'as':74.9216, 'ba':137.327, 
    'be':9.012182,'bi':208.98038, 'b':10.811, 'br':79.904, 'cd':112.411, 
    'cs':132.90545, 'ca':40.078, 'c':12.0107, 'ce':140.116, 'cl':35.4527, 
    'cr':51.9961, 'co':58.9332, 'cu':63.546, 'dy':162.5, 'er':167.26, 
    'eu':151.964, 'f':18.9984032, 'gd':157.25, 'ga':69.723, 'ge':72.61, 
    'au':196.96655, 'hf':178.49, 'he':4.002602, 'ho':164.93032, 'h':1.00794, 
    'in':114.818, 'i':126.90447, 'ir':192.217, 'fe':55.845, 'kr':83.8, 
    'la':138.9055, 'pb':207.2, 'li':6.941, 'lu':174.967, 'mg':24.305, 
    'mn':54.938049, 'hg':200.59, 'mo':95.94, 'nd':144.24, 'ne':20.1797, 
    'ni':58.6934, 'nb':92.90638, 'n':14.00674, 'os':190.23, 'o':15.9994, 
    'pd':106.42, 'p':30.973762, 'pt':195.078, 'k':39.0983, 'pr':140.90765, 
    'pa':231.03588, 're':186.207, 'rh':102.9055, 'rb':85.4678, 'ru':101.07, 
    'sm':150.36, 'sc':44.95591, 'se':78.96, 'si':28.0855, 'ag':107.8682, 
    'na':22.98977, 'sr':87.62, 's':32.066, 'ta':180.9479, 'te':127.6, 
    'tb':158.92534, 'tl':204.3833, 'th':232.0381, 'tm':168.93421, 
    'sn':118.71, 'ti':47.867, 'w':183.84, 'u':238.0289, 'v':50.9415, 
    'xe':131.29, 'yb':173.04, 'y':88.90585, 'zn':65.39, 'zr':91.224
}

# Full atomic number dictionary
atomicNumber = {
    1:'h', 2:'he', 3:'li', 4:'be', 5:'b', 6:'c', 7:'n', 8:'o', 9:'f', 
    10:'ne', 11:'na', 12:'mg', 13:'al', 14:'si', 15:'p', 16:'s', 
    17:'cl', 18:'ar', 19:'k', 20:'ca', 21:'sc', 22:'ti', 23:'v', 
    24:'cr', 25:'mn', 26:'fe', 27:'co', 28:'ni', 29:'cu', 30:'zn', 
    31:'ga', 32:'ge', 33:'as', 34:'se', 35:'br', 36:'kr', 37:'rb', 
    38:'sr', 39:'y', 40:'zr', 41:'nb', 42:'mo', 43:'tc', 44:'ru', 
    45:'rh', 46:'pd', 47:'ag', 48:'cd', 49:'in', 50:'sn', 51:'sb',
    52:'te', 53:'i', 54:'xe', 55:'cs', 56:'ba', 57:'la', 58:'ce',
    59:'pr', 60:'nd', 61:'pm', 62:'sm', 63:'eu', 64:'gd', 65:'tb', 
    66:'dy', 67:'ho', 68:'er', 69:'tm', 70:'yb', 71:'lu', 72:'hf', 
    73:'ta', 74:'w', 75:'re', 76:'os', 77:'ir', 78:'pt', 79:'au', 
    80:'hg', 81:'tl', 82:'pb', 83:'bi', 90:'th', 91:'pa', 92:'u'
}

def get_symbol(atomic_num):
    """Returns element symbol from atomic number."""
    return atomicNumber.get(atomic_num, 'X').title()

def get_unit_vector(vec):
    """Returns the unit vector of a given vector."""
    norm = np.linalg.norm(vec)
    if norm < 1e-6:
        return np.zeros_like(vec)
    return vec / norm